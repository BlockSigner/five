# Production context:
# All deploys from the main repository branch
# will inherit these settings.
[context.production]
  command = "yarn generate-prod"

# Deploy Preview context:
# All deploys generated from a pull/merge request
# will inherit these settings.
[context.deploy-preview]
  command = "yarn generate-staging"

# Branch deploy context:
# All deploys that are not from a pull/merge request
# or from the production branch will inherit these settings.
[context.branch-deploy]
  command = "yarn generate-staging"

# More specific redirect to catch production
[[redirects]]
  from = "https://www.videoident.me/api/*"
  to = "https://seven.videoident.me/api/:splat"
  status = 200
  signed = "PROXY_REQUEST_KEY"

[[redirects]]
  from = "/api/*"
  to = "https://seven-staging.videoident.me/api/:splat"
  status = 200
  signed = "PROXY_REQUEST_KEY"


[[redirects]]
  from = "/*"
  to = "/ch/de"
  force = true
  status = 302
  conditions = {Language = ["de"]}
# Otherwise, display CH/EN page
[[redirects]]
  from = "/*"
  to = "/ch/en"
  force = true
  status = 302
